\input{dofirst}
\documentclass{standalone}
%\usepackage{tabularray}
\input{preamble}
\input{tikzpacket-newer-sa-da}
\input{tikznetwork}

\begin{document}%
    \begin{tikzpicture}

    \usetikzlibrary{math,calc}
    \node[align=left, opacity=0, anchor=south west] at (0,0) (sample) {SA:~\texttt{fc00:0:5:6:7:}};
    \tikzmath{
        coordinate \wNode;
        \wNode1=(sample.east) - (sample.west);
        \n1= {veclen(\wNodex1,\wNodey1) - \pgflinewidth};
        \wNode2=(sample.north) - (sample.south);
        \n2= {veclen(\wNodex2,\wNodey2) - \pgflinewidth};
    }
    \def\pktwidth{\n1}
    \def\pktheight{\n2}

    \tikzset{artr/.style={router}}
    \tikzset{abigrtr/.style={router, scale=1.5, semithick}} % thin (0.4pt) at scale 1.5 is semithick (0.6pt)
    \tikzset{albl/.style={font=\Large}}

        \node[abigrtr](4){4};
        
        \node[below=.1cm of 4, albl] (label) {End with uSID (uN)};

        \node[below=.1cm of label](4b){};
        \node[anchor=east, minimum width=1cm] at (4b-|4.west)(4bl){};
        \node[anchor=west, minimum width=1cm] at (4b-|4.east)(4br){};

    % pkt2
    \node[right=.2cm of 4br.east, anchor=north west](pkt2){%
      \ipsrhpktnew[\pktwidth pt]{\texttt{fc00:0:1::1}}{\texttt{\underline{fc00:0:5:6:7::}}}%
      {(\texttt{fc00:0:5:6:7::},\\\phantom{(}\texttt{fc00:0:2:3:4::})}%
      {\underline{0}}%
    };
    % size of pkt2
    %\path let \p1=($(pkt2.north east)-(pkt2.south west)$) in  (pkt2.north) node[above=1cm,draw,fill=white] {The node \texttt{pkt2} is \x1\ wide and \y1\ tall.};

    % pkt1
    \node[left=.2cm of 4bl.west, anchor=south east] at (4bl.west|-pkt2.south) (pkt1){%
      \ipsrhpktnew[\pktwidth pt]{\texttt{fc00:0:1::1}}{\texttt{fc00:0:4::}}%
      %
      {(\texttt{fc00:0:5:6:7::},\\\phantom{(}\texttt{fc00:0:2:3:4::})}%
      {1}%
    };
    % size of pkt1
    %\path let \p1=($(pkt1.north east)-(pkt1.south west)$) in  (pkt1.north) node[above=1cm,draw,fill=white] {The node \texttt{pkt1} is \x1\ wide and \y1\ tall.};
    
        \node[anchor=east, minimum width=1cm] at (pkt1-|4.west)(4bl){};
        \node[anchor=west, minimum width=1cm] at (pkt1-|4.east)(4br){};

        \draw[bigarrow] (4bl.west) -- (4bl.east);
        \draw[bigarrow] (4br.west) -- (4br.east);


    \node[artr, anchor=west] at (4-|pkt1.west) (1) {1};
    \node[artr, anchor=east] at (4-|pkt2.east) (7) {7};
    \node[artr] at ($(4)!0.6!(7)$) (5) {5};
    \node[artr] at ($(4)!0.8!(7)$) (6) {6};
    
    \draw[connec, dashed] (4) -- (1);
    \draw[connec, dashed] (4) -- (5);
    \draw[connec, dashed] (5) -- (6);
    \draw[connec, dashed] (6) -- (7);

    \pgfsize{\mywidth}{\myheight}
\end{tikzpicture}
\typeout{W=\the\mywidth}
\typeout{H=\the\myheight}
\end{document}



